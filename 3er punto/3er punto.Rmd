---
title: "3er punto"
output: html_document
date: "2023-10-02"
---


```{r cars}
# install.packages("readxl")
library(readxl)

```

```{r}
datos <- read_excel("Metro.xlsx")
View(datos)
```

```{r}
x <- c(datos$`Tiempo V1` , datos$`Tiempo V2` , datos$`Tiempo V3`)
y <- c(datos$`Velocidad V1` , datos$`Velocidad V2` , datos$`Velocidad V3`)

datos <- data.frame(x=x,y=y)
```

# Analisis descritivo
```{r}
plot(x , y)
```

El gráfico relaciona la proporcionalidad inversa entre la variable tiempo y la variable velocidad de cada uno de los vagones de manera correcta.

## Modelo 1:  (a\*exp(b\*x)

```{r}
#install.packages("minpack.lm")
```


```{r}
# Cargar la biblioteca minpack.lm
library(minpack.lm)


# Función de modelo
modelo <- function(x,a,b) {
  return(a*exp(b*x))
}

# Estimar valores iniciales utilizando nlsLM
ajuste_inicial <- nlsLM(data= datos, y ~ modelo(x, a, b),
                        start = list(a = 1,b = 1))

# Obtener los valores iniciales estimados
valores_iniciales_estimados <- coef(ajuste_inicial)
print(valores_iniciales_estimados)

# Ajustar el modelo final con los valores iniciales estimados
ajuste_final <- nlsLM(y ~ modelo(x,a,b), start = valores_iniciales_estimados)

```


```{r}
plot(y ~ x, data = datos)
lines(seq(1, 3, length.out = 50), 
      predict(ajuste_final, 
              newdata = data.frame(x = seq(1, 3, length.out = 50))))

```


## Modelo 2: a \* x\^b

```{r}

# Función de modelo
modelo <- function(x,a,b) {
  return(a*(x^b))
}

# Estimar valores iniciales utilizando nlsLM
ajuste_inicial <- nlsLM(data= datos, y ~ modelo(x, a, b),
                        start = list(a = 1,b = 1))

# Obtener los valores iniciales estimados
valores_iniciales_estimados <- coef(ajuste_inicial)
print(valores_iniciales_estimados)

# Ajustar el modelo final con los valores iniciales estimados
ajuste_final <- nlsLM(y ~ modelo(x,a,b), start = valores_iniciales_estimados)


```


```{r}
plot(y ~ x, data = datos)
lines(seq(1, 3, length.out = 50), 
      predict(ajuste_final, 
      newdata = data.frame(x = seq(1, 3, length.out = 50))))

```



```{r}
# Ajustar un modelo spline cúbico a los vagones
spline_model_vagon<- smooth.spline(datos$x, datos$y, df = 6)  # Puedes ajustar df según la suavidad deseada

# Graficar los datos originales y el modelo spline ajustado
plot(datos$x, datos$y, type = "b", col = "blue", xlab = "Tiempo de llegada", ylab = "Velocidad de los vagones")
lines(spline_model_vagon$x, spline_model_vagon$y, col = "red", lwd = 2)
legend("topright", legend = c("Datos Originales", "Spline Ajustado"), col = c("blue", "red"), lty = 1, lwd = 2)

# Evaluar el modelo en nuevos valores de tiempo (por ejemplo, para hacer predicciones)
nuevos_tiempos <- c(4, 5, 7)  # Nuevos valores de tiempo
predicciones <- predict(spline_model_vagon, xout = nuevos_tiempos)
print(predicciones$y)



```
```{r}
spline_model_vagon
```

Con un suavizado moderado de los datos (spar= 1.045756 ), y una penalización relativamente pequeña (lambda es igual a 0.001086861), y GCV es igual a 0.003125936, medida de la bondad de ajuste del modelo spline suavizado , lo que sugiere un buen ajuste del modelo a los datos; lo que indica que la velocidad con que llegan los tres primeros  vagones del Metro de Medellín a las estaciones se pueden modelar y/o ajustar con un modelo de regresion no lineal como el spline suavizado, teniendo en cuenta el tiempo de llegada de éstos mismos a la estación, y ademas se pueden hacer predicciones, teniendo en cuenta que en condiciones normales de operación del servicio, el tiempo que emplea un tren al entrar por cierta punto de referencia a la estación no es exageradamente grande y se puede medir en segundos.










PUNTO DE LA ESTATURA VS EDAD

```{r}
library(readr)
maduraciónsexual <- read_csv2("maduraciónsexual.csv")
head(maduraciónsexual)

#View(maduraciónsexual)
#fecha_actual <- Sys.Date()

#maduraciónsexual$FECHANACIM <- as.Date(maduraciónsexual$FECHANACIM, format = "%Y-%m-%d")  # Asegúrate de que la fecha de nacimiento esté en el formato correcto
#maduraciónsexual$Edad <- as.integer(difftime(fecha_actual, maduraciónsexual$FECHANACIM, units = "days") / 365)

#head(maduraciónsexual)

```
 
```{r}
masculino <- maduraciónsexual[maduraciónsexual$SEXO == 1, ]
femenino <- maduraciónsexual[maduraciónsexual$SEXO == 2, ]

```


```{r}
plot(femenino$EDAD, femenino$ESTATURAP1, pch = 19, col = "blue",  xlab = "Edad mujeres", ylab = "Estatura mujeres")
media_estatura <- tapply(femenino$ESTATURAP1, femenino$EDAD, mean)
lines(names(media_estatura), media_estatura, col = "red", type = "b")

```
```{r}
mujer<- data.frame(Eda=femenino$EDAD , esta=femenino$ESTATURAP1)
modmujer= nls(esta~ SSlogis(log(Eda), Asym, xmid, scal), mujer)
summary(modmujer)
## the coefficients only:
coef(modmujer)
## including their SE, etc:
coef(summary(modmujer))
```


Según los resultados arrojados acerca del ajuste de la curva del modelo logistico suavizado, Asym=199.16051  representa el valor asintótico superior o límite superior que la variable dependiente (en este caso, la estatura) se acerca a medida que la variable independiente (la edad) aumenta o disminuye infinitamente. En otras palabras, "Asym" indica el valor máximo al que tiende la variable dependiente. En un contexto de crecimiento, esto podría representar la estatura máxima que una persona podría alcanzar. xmid=1.53644  representa la ubicación del punto medio o el valor de la variable independiente en el cual la variable dependiente alcanza la mitad de su valor asintótico superior. En el contexto de la relación entre la edad y la estatura, "xmid" indica la edad en la que se espera que la estatura alcance el 50% de su valor máximo; y scal   0.9338134 representa la ubicación del punto medio o el valor de la variable independiente en el cual la variable dependiente alcanza la mitad de su valor asintótico superior. En el contexto de la relación entre la edad y la estatura, "xmid" indica la edad en la que se espera que la estatura alcance el 50% de su valor máximo


```{r}


ggplot(data = mujer, aes(x = Eda, y = esta)) +
  geom_point() +
  labs(x = "Edad", y = "Estatura") +
  geom_smooth(method = "nls", 
              formula = y ~ 190 / (1 + exp(-b * (x - x0))),
              method.args = list(start = c(b = 1, x0 = 10)),
              se = FALSE, 
              color = "blue") +
  theme_minimal()

```

modelar la estatura en función de la edad es util a la hora de comprender cómo la estatura cambia a medida que las personas envejecen, es por ello que se implementa un modelo de regresión no lineal logistico para observar esta tendencia. En ella se puede ver que para hombres (niños) hasta cierta edad  15 a 17 años la estatura va progresivamente en aunmento, mientras que de ahí en adelante se mantiene relativamente estable, hasta de nuevo llegar a una edad donde la estatura empieza a decrecer.



```{r}
plot(masculino$EDAD,masculino$ESTATURAP1, pch = 19, col = "blue",  xlab = "Edad hombres", ylab = "Estatura Hombres")
media_esta <- tapply(masculino$ESTATURAP1,masculino$EDAD, mean)
lines(names(media_esta), media_esta, col = "red", type = "b")
```
 
 
 
```{r}

plot( maduraciónsexual$EDAD, maduraciónsexual$ESTATURAP1, pch = 19, col = "blue",  xlab = "Edad", ylab = "Estatura")
media_estatu<- tapply(maduraciónsexual$ESTATURAP1, maduraciónsexual$EDAD, mean)
lines(names(media_estatu), media_estatu, col = "red", type = "b")

```
 


```{r}
hombre <- data.frame(edad = masculino$EDAD, estatura = masculino$ESTATURAP1)
modelo_logistico_hombre <- nls(estatura ~ 190 / (1 + exp(-b * (edad - x0))), 
                               data = hombre, 
                               start = list(b = 1, x0 = 10))
summary(modelo_logistico_hombre)
```

Un valor positivo de $b$ indica un aumento en la estatura a medida que la edad aumenta, en este caso, $b$ se estima en aproximadamente $0.148827$ lo cual muestra relativo aumento a medida que se cumplen los primero años de edad; mientras que $x_0$ es el punto de inflexión de la curva logística. $x_0$ se estima en aproximadamente $3.369932$ los cuales representan las estimaciones de la pendiente y el desplazamiento horizontal (traslación) de la curva logística, respectivamente.

En este caso, como los parametros son estadisticamente significativos, se pueden ajustar los datos a este modelo; 
Achieved convergence tolerance: 4.834e-07 indica la tolerancia de convergencia alcanzada en el proceso de ajuste del modelo, en este caso, se alcanzó una tolerancia muy baja, lo que sugiere una buena convergencia del modelo.


```{r}
library(ggplot2)
ggplot(data = hombre, aes(x = edad, y = estatura)) +
  geom_point() +
  labs(x = "Edad de hombres", y = "Estatura de hombres") +
  geom_smooth(method = "nls", 
              formula = y ~ 190 / (1 + exp(-b * (x - x0))),
              method.args = list(start = c(b = 1, x0 = 10)),
              se = FALSE, 
              color = "blue") +
  theme_minimal()

```

Aquí el modelo está tratando de describir cómo la estatura de los hombres cambia a medida que envejecen. Por ello, un gráfico del ajuste del modelo ayuda a visualizar que para el género masculino la tendencia de la altura es a crecer hasta cierta edad, y que despúes de esto podrían mantenerse estable estas metricas hasta nuevamente marcar tendencia, esta vez a decrecer luego de cumplir cierta cantidad de años; sin embargo esto no se refleja en este gráfico, donde solo es observable la trayectoria al crecimiento progresivo respecto a edades tempranas.
 
 
 
```{r}
Estatura <- maduraciónsexual$ESTATURAP1
Edad <- maduraciónsexual$EDAD

datos<-data.frame(Estatura, Edad)
plot(Estatura~ Edad, data=datos)
```

En general se observa que el crecimiento de las personas en este estudio es hasta edades entre 14-17 y que despues de cumplir estos años, parece mantenerse estables entre 150-170 centímetros  de estatura.

 

```{r}
nuevas_edades <- data.frame(edad = c(20, 25, 30, 35, 40))

pronosticos <- predict(modelo_logistico_hombre, newdata = nuevas_edades)
pronosticos

```
Según los datos proporcionados, se realiza un pronostico de estaturas para edades  futuras de los hombres incluidos en este estudio para conocer la estatura que tendrían en tales edades.
 
```{r}
deviance(modelo_logistico_hombre)

```












PUNTO DE NADADORES

```{r}
Nadadores <- read.table("Finalestilolibre400metros.txt", header = TRUE, sep = "\t",  stringsAsFactors = FALSE)
head(Nadadores)
```

```{r}
sexo<-c(rep(1,36),rep(2,43))
```

```{r}
temp<-matrix(temp,ncol=16,byrow=T)
temp
temp2<-matrix(as.numeric(temp[,-c(1,2)]),ncol=14,byrow=F)
temp2
tiempos.seg<-cbind(temp2[,c(1 ,2)],60*temp2[,c(3,5,7,9,11,13)]+temp2[,c(3,5,7,9,11,13)+1])
tiempos.seg
matplot(t(tiempos.seg),type="b")
boxplot(tiempos.seg)
plot(tiempos.seg[,1],tiempos.seg[,8])
cor(tiempos.seg)
temp3<-apply(tiempos.seg,1,rank)
cor(temp3)
```




